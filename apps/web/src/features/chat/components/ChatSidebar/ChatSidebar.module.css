/* ============================================================================
   Chat Sidebar Styles
   ============================================================================
   Navigation sidebar styles for the chat interface.
   Mobile-first: slides in from left as overlay.
   Desktop: part of layout, can be collapsed.
   ============================================================================ */

/* ----------------------------------------------------------------------------
   Sidebar
   ----------------------------------------------------------------------------
   Navigation panel with action buttons.
   Mobile: fixed overlay, slides in from left.
   Desktop: part of flex layout, can be collapsed.
   ---------------------------------------------------------------------------- */
.sidebar {
  position: fixed;
  top: 0;
  left: 0;
  width: var(--sidebar-width);
  height: 100dvh;
  background: var(--gradient-sidebar);
  border-right: 1px solid var(--border-color);
  display: flex;
  flex-direction: column;
  z-index: 100;

  /* Mobile: hidden by default, slide in */
  transform: translateX(-100%);
  transition:
    transform var(--transition-normal),
    width var(--transition-normal);
}

.sidebarOpen {
  transform: translateX(0);
}

/* Desktop: part of CSS Grid layout, fixed in first column */
@media (min-width: 768px) {
  .sidebar {
    position: relative;
    grid-column: 1; /* Explicitly place in first grid column */
    transform: translateX(0);
    /* Width is controlled by grid-template-columns in container */
    width: 100%;
    height: 100dvh;
    overflow: hidden;
    /* Remove width transition to prevent CLS */
    transition: none;
  }

  /*
   * When sidebar is closed on desktop, collapse it visually.
   * Grid column still exists but sidebar content is hidden.
   */
  .sidebarClosed.sidebarHydrated {
    width: 0;
    padding: 0;
    border: none;
    overflow: hidden;
  }
}

/* ----------------------------------------------------------------------------
   Sidebar Navigation
   ----------------------------------------------------------------------------
   Main navigation area with action buttons.
   ---------------------------------------------------------------------------- */
.sidebarNav {
  flex: 1;
  padding: var(--spacing-md);
  overflow-y: auto;

  /* Prevent layout shift from async content loading */
  contain: layout style;
  min-height: 0; /* Prevents flex overflow thrash */
}

/* ----------------------------------------------------------------------------
   Sidebar Profile
   ----------------------------------------------------------------------------
   User profile section at the top of the sidebar.
   ---------------------------------------------------------------------------- */
.sidebarProfile {
  padding: var(--spacing-md);
  padding-top: calc(var(--header-height) + var(--spacing-md));
  border-bottom: 1px solid var(--border-color);

  /* Prevent layout shift from async content loading */
  contain: layout style;
}

@media (min-width: 768px) {
  .sidebarProfile {
    padding-top: calc(var(--spacing-3xl) + var(--spacing-md));
  }
}

/* ----------------------------------------------------------------------------
   Sidebar Section
   ----------------------------------------------------------------------------
   Grouped section within sidebar navigation.
   ---------------------------------------------------------------------------- */
.sidebarSection {
  margin-top: var(--spacing-md);
  padding-top: var(--spacing-md);
  border-top: 1px solid var(--color-neutral-100);

  /* Prevent layout shift from async content loading */
  contain: layout style;
}

.sidebarSection:first-child {
  margin-top: 0;
  padding-top: 0;
  border-top: none;
}

/* ----------------------------------------------------------------------------
   Sidebar Footer
   ----------------------------------------------------------------------------
   Contains logout and other secondary actions.
   ---------------------------------------------------------------------------- */
.sidebarFooter {
  padding: var(--spacing-md);
  border-top: 1px solid var(--border-color);
  display: flex;
  flex-direction: column;
  gap: var(--spacing-sm);
  flex-shrink: 0;
  margin-top: auto;
}

/* Theme toggle wrapper */
.themeToggleWrapper {
  display: flex;
  justify-content: center;
  padding-bottom: var(--spacing-xs);
}

/* ----------------------------------------------------------------------------
   Sidebar Button
   ----------------------------------------------------------------------------
   Full-width button with icon and text label.
   ---------------------------------------------------------------------------- */
.sidebarButton {
  width: 100%;
  min-height: 48px;
  display: flex;
  align-items: center;
  gap: var(--spacing-sm);
  padding: var(--spacing-sm) var(--spacing-md);
  color: var(--color-text-primary);
  border-radius: var(--radius-md);
  font-size: var(--font-size-base);
  font-weight: var(--font-weight-medium);
  text-align: left;
  transition:
    background-color var(--transition-fast),
    transform var(--transition-fast);

  /* Prevent text selection on rapid taps */
  -webkit-user-select: none;
  user-select: none;
  -webkit-tap-highlight-color: transparent;
}

.sidebarButton:hover {
  background-color: var(--color-primary-light);
}

.sidebarButton:active {
  transform: scale(0.98);
}

/* ----------------------------------------------------------------------------
   Collapse Button (Desktop)
   ----------------------------------------------------------------------------
   Inside the sidebar, allows collapsing on desktop.
   Hidden on mobile.
   ---------------------------------------------------------------------------- */
.collapseButton {
  display: none; /* Hidden on mobile */
}

@media (min-width: 768px) {
  .collapseButton {
    display: flex;
    width: 32px;
    height: 32px;
    align-items: center;
    justify-content: center;
    color: var(--color-text-secondary);
    border-radius: var(--radius-md);
    position: absolute;
    top: var(--spacing-md);
    right: var(--spacing-md);
    transition:
      background-color var(--transition-fast),
      color var(--transition-fast);
  }

  .collapseButton:hover {
    background-color: var(--color-primary-light);
    color: var(--color-primary);
  }
}

/* ----------------------------------------------------------------------------
   Skeleton Placeholders
   ----------------------------------------------------------------------------
   Fixed-height placeholders for Suspense fallbacks to prevent CLS.
   Heights match actual component dimensions.
   ---------------------------------------------------------------------------- */
.skeletonProfile {
  min-height: 72px;
  background: linear-gradient(
    90deg,
    var(--color-neutral-100) 25%,
    var(--color-neutral-50) 50%,
    var(--color-neutral-100) 75%
  );
  background-size: 200% 100%;
  border-radius: var(--radius-md);
  animation: skeleton-shimmer 1.5s ease-in-out infinite;
}

.skeletonDiscoverNav {
  min-height: 48px;
  background: linear-gradient(
    90deg,
    var(--color-neutral-100) 25%,
    var(--color-neutral-50) 50%,
    var(--color-neutral-100) 75%
  );
  background-size: 200% 100%;
  border-radius: var(--radius-md);
  animation: skeleton-shimmer 1.5s ease-in-out infinite;
}

.skeletonConversationHistory {
  min-height: 48px;
  background: linear-gradient(
    90deg,
    var(--color-neutral-100) 25%,
    var(--color-neutral-50) 50%,
    var(--color-neutral-100) 75%
  );
  background-size: 200% 100%;
  border-radius: var(--radius-md);
  animation: skeleton-shimmer 1.5s ease-in-out infinite;
}

.skeletonJournalHistory {
  min-height: 48px;
  background: linear-gradient(
    90deg,
    var(--color-neutral-100) 25%,
    var(--color-neutral-50) 50%,
    var(--color-neutral-100) 75%
  );
  background-size: 200% 100%;
  border-radius: var(--radius-md);
  animation: skeleton-shimmer 1.5s ease-in-out infinite;
}

.skeletonMeditations {
  min-height: 48px;
  background: linear-gradient(
    90deg,
    var(--color-neutral-100) 25%,
    var(--color-neutral-50) 50%,
    var(--color-neutral-100) 75%
  );
  background-size: 200% 100%;
  border-radius: var(--radius-md);
  animation: skeleton-shimmer 1.5s ease-in-out infinite;
}

.skeletonProgressWidget {
  min-height: 48px;
  background: linear-gradient(
    90deg,
    var(--color-neutral-100) 25%,
    var(--color-neutral-50) 50%,
    var(--color-neutral-100) 75%
  );
  background-size: 200% 100%;
  border-radius: var(--radius-md);
  animation: skeleton-shimmer 1.5s ease-in-out infinite;
}

@keyframes skeleton-shimmer {
  0% {
    background-position: -200% 0;
  }
  100% {
    background-position: 200% 0;
  }
}
